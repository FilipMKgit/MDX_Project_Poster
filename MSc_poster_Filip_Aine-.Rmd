---
title: Statistical Design and Analysis of a Non-Inferiority Clinical Trial
author:
  - name: Áine Glynn
    affil: 1
  - name: Filip Kłosowski
    affil: 1
affiliation:
  - num: 1
    address: School of Mathematical and Statistical Sciences, University of Galway
logoleft_name: logo2UG.png

poster_height: "594mm"
poster_width: "841mm"
column_numbers: 5
column_margins: "0.5in"
primary_colour:	"#5A3A6E"	
secondary_colour:	"#a80050"	
accent_colour:	"#a80050"
author_textcol: "white"
title_textsize: "72pt"
author_textsize: "44pt"
body_textsize: "22pt"
output: 
  posterdown::posterdown_html:
    self_contained: true
    pandoc_args: --mathjax
    number_sections: false
knit: pagedown::chrome_print
---
<style>
p {
  line-height: 1.30;
  margin-top: 0.30em !important;
  margin-bottom: 0.55em !important;
}

.section h1 + p,
.section h2 + p,
.section h3 + p {
  margin-top: 0.3em !important;
}
</style>


```{css, echo=FALSE}


.logo-left img {
  height: 50px;
  width: auto;
  display: block;
}

div.poster_title{
  width: 80%;
  text-align: center;
  margin-left: auto;
  margin-right: auto;
  
}

.poster_author,
.poster_affiliation {
  text-align: center !important;
  margin-left: auto;
  margin-right: auto;
}

.section h4 {
  break-after: column;
}

div.footnotes {
  font-size: 16pt;
}

.section h1 { font-size: 42pt; }
.section h2 { font-size: 36pt;
  margin-top: 0.6em;
  margin-bottom: 0.35em;}
.section h3 { font-size: 30pt; }

table {
  border: 2px solid #444;
}

table th {
  border-bottom: 2px solid #444;
}

a { overflow-wrap: anywhere; }

```

<!-- Don't change anything above, except the title and author names, unless you know what you are doing. -->

<!-- I chose green for primary colour because maroon was the default so some people might stay with it, and then the next most obvious colour is blue as it's very techy/ mathematical so I expect to see a lot of blue posters. To stand out I chose green, it's also very pleasant for the eye. Let me know what you think -->



```{r, include=FALSE}
knitr::opts_chunk$set(echo = FALSE,
                      warning = FALSE,
                      tidy = FALSE,
                      message = FALSE,
                      fig.align = 'center',
                      out.width = "100%")
options(knitr.table.format = "html") 
# Load any additional libraries here
library(tidyverse)
library(plotly)
library(kableExtra)
library(dplyr)
```

```{r}
#tables code
tbl_safety <- tibble::tibble(
  Endpoint = c(
    "30-Day Amputation",
    "30-Day Death",
    "30-Day Target Vessel\nRevascularisation (TVR)"
  ),
  `Pooled\nEstimate` = c("0", "0", "0.0517"),
  `95% CI` = c("[0.0000,\n1.0000]", "[0.0000,\n1.0000]", "[0.0234,\n0.1104]"),
  `Recommended\nPerformance Goal` = c("1%", "1%", "11%"),
  `Justifiable\nRange` = c("0–1%", "0–1%", "2–11%")
)

tbl_efficacy <- tibble::tibble(
  Endpoint = c(
    "Rutherford Classification Change (12 months): Improved or No Change",
    "Rutherford Classification Change (12 months): Increase by One Class"
  ),
  `Pooled\nEstimate` = c("0.9583", "0.0441"),
  `95% CI` = c("[0.8786,\n0.9865]", "[0.0143,\n0.1280]"),
  `Recommended\nPerformance Goal` = c("87%", "1%"),
  `Justifiable\nRange` = c("87–99%", "1–13%")
)


#styling

make_col_table <- function(df, header_col, body_col) {
  kbl(df, format = "html", escape = FALSE, align = "c") %>%
    kable_styling(
      full_width = TRUE,
      bootstrap_options = c("striped"),
      position = "center",
      font_size = 16
    ) %>%
    row_spec(0, bold = TRUE, color = "white", background = header_col) %>%
    row_spec(1:nrow(df), background = body_col) %>%
    column_spec(1, bold = TRUE) %>%
    add_header_above(setNames(ncol(df), " "), bold = FALSE) 
}
```


# Background 
Non-Inferiority (NI) trials are increasingly used in clinical research, especially when a placebo is unethical and when new treatments aim for similar efficacy with other advantages[^1][^2]. However, they are frequently poorly designed and interpreted. Confusion arises around the specification of NI margins, selection of appropriate active controls and interpretation of statistical conclusions. This may lead to adverse consequences for manufacturers, clinicians and the wider public.

***What is a Non-Inferiority Trial?***

- **Non-Inferiority Trials:** Clinical studies designed to demonstrate a new treatment is not clinically worse than an active control by more than a pre-specified margin.

- **Non-Inferiority Margin (Δ):** Pre-specified and approved threshold the new treatment must meet to prove it preserves a clinically meaningful portion of the active control's effect [^3].

- NI Trials typically run like randomised control trials but compare the new treatment with an **active control**; an established standard of care used.

- NI must show the new treatment’s estimated effect, along with its Confidence Interval (CI), lies within the pre-specified NI margin.

[^1]: Cuzick & Sasieni, 2022. , doi: 10.1038/s41416-022-01937-w
[^2]: Sandie et al., 2022, doi: 10.1186/s13063-022-06118-x

# Aims & Objectives
1. Justify the Δ using historical evidence.
2. Design and assess appropriate NI trial design parameters.
3. Develop a Shiny application for exploring sample size requirements.
4. Analyse simulated data and evaluate NI conclusions.
5. Examine the assumptions and limitations of NI designs.

# Biomimics 3D Stent
It's 2008 and we have just been hired as statisticians for BioMimics 3D Vascular Stent’s pivotal NI trial:

<img src="BM3D_image.png"
     style="
       width:75%;
       display:block;
       margin:12px auto;
       border:2px solid #5A3A6E;
       border-radius:10px;
       box-shadow:0 5px 12px rgba(0,0,0,0.16);
       background:white;
       padding:3px;
     ">

The BioMimics 3D stent is a peripheral vascular stent implanted in the leg to improve blood flow in patients with peripheral vascular disease (narrowing of the peripheral blood vessels). Unlike conventional straight stents, it features a 3D helical design, intended to improve vascular performance and blood flow to affected vessels.

From a statistical perspective, this study is a single arm trial evaluated against a fixed Performance Goal (PG). Such trials are commonplace for demonstrating NI in medical devices due to cost, extended timelines and challenges with recruitment and blinding. Strictly speaking they are no different than a single arm trial against a fixed endpoint. The similarity to an NI trial is that the endpoint *(i.e. the PG)* is chosen to represent a ‘worst case’ for safety (or efficacy) to claim NI. As such, many NI trials reported are actually single arm trials with a PG.

We derived the PG and the corresponding NI margins by setting safety and efficacy endpoints using a targeted literature review and previous meta-analysis[^3][^4][^5]. This was done using IPA statistics and applying a random-effects model.

[^3]: FDA, 2022. , 2016 https://www.fda.gov/media/78504/download
[^4]: Werk et al. , 2008. , doi: 10.1161/CIRCULATIONAHA.107.735985
[^5]: Tepe et al. , 2008. , doi: 10.1056/NEJMoa0706356

For safety, the margin is set at the upper bound of the 95% CI, representing the maximum acceptable level of harm. For efficacy, the margin is set at the lower bound of the 95% CI, representing the minimum clinical benefit that must be preserved. Crossing either bound results in failure to demonstrate NI.

Our project involves working with BioMimics’ lead scientist, to design, assess and interpret this trial from a statistician’s perspective. This includes:

- Defining and justifying appropriate safety and efficacy endpoints.

- Ensuring the trial is statistically powered and ethically justified.

- Selecting valid analysis methods.

- Correctly interpreting and communicating NI conclusions.

## Meta-Analysis

Prior to being available on the market all medical products must obtain approval from the relevant regulatory authority. This is done through a series of clinical studies where the medical product is monitored for safety and effectiveness.

Initially, a feasibility study is conducted. If successful, a pivotal study is proposed. Our pivotal study is a single-arm PG trial. The PG and NI margin must be statistically justified, adequately powered and grounded in clinical evidence.

```{r}
#safety table insert
make_col_table(
  tbl_safety,
  header_col = "#9C1C6B",  
  body_col   = "#F6C1DE"
)
```

```{r}
#efficacy table insert
make_col_table(
  tbl_efficacy,
  header_col = "#C9A400", 
  body_col   = "#FFF1A8"  
)

```

# Sample Size
The sample size was calculated for the safety outcome.  Based on an estimated safety proportion of 0.95 a sample size of **n = 174** had 80% power based on a one-sided test for a binomial at the $\alpha=0.025$ significance level to declare NI against a PG for safety of 0.89. The sample size was determined via Monte Carlo simulation using a Wilson score CI-based decision rule.

## Shiny Application
As part of the sample size calculation we developed an interactive Shiny application to support statistical planning for this trial and future trials of the same nature. The application allows users to explore how sample size requirements vary under different design assumptions, including power, significance level and effect size.

<img src="appsc.JPG"
     style="
       width:110%;
       display:block;
       margin:20px auto;
       margin-left:-5%;
       border:3px solid #5A3A6E;
       border-radius:12px;
       background:white;
       padding:6px;
       filter: brightness(1.05) contrast(1.05);
     ">
     
The application also supports multiple CI–based decision rules. Exploratory analyses within the app were used to compare alternative methods and assess their impact on NI conclusions and required sample size. The Wilson score CI approach was ultimately selected based on these analyses.

####

# Next Steps
- Carry out an extensive simulation study to compare the different approaches available to generate a CI for a population proportion in single arm medical device trials. 

- Calculate the sample size needed for efficacy assuming a gate-keeping approach for joint outcomes. 

- Calculate the sample size needed for safety and efficacy if an interim analysis is required. 

- Finalise a Statistical Analysis Plan (SAP) specifying endpoints, estimators, CI methods and NI decision rules prior to data unblinding.

- Conduct sensitivity and tipping-point analyses to evaluate the robustness of conclusions to small changes in assumptions or observed event counts.

# GitHub
<p>
*Meta-Analysis:*

<a href="https://github.com/FilipMKgit/MDX_Meta-Analysis">
github.com/FilipMKgit/MDX_Meta-Analysis
</a>
</p>

<p>
*Shiny:*

<a href="https://github.com/FilipMKgit/Margin-Jinn">
github.com/FilipMKgit/Margin-Jinn
</a>
</p>

<p>
*Poster:*

<a href="https://github.com/FilipMKgit/MDX_Project_Poster">
github.com/FilipMKgit/MDX_Project_Poster
</a>
</p>

# References
